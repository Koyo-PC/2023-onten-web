THREE.OrbitControls=function(N,O){this.object=N;this.domElement=(O!==undefined)?O:document;this.enabled=true;this.target=new THREE.Vector3();this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=false;this.dampingFactor=0.25;this.enableZoom=true;this.zoomSpeed=1;this.enableRotate=true;this.rotateSpeed=1;this.enablePan=true;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.enableKeys=true;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.getPolarAngle=function(){return S.phi};this.getAzimuthalAngle=function(){return S.theta};this.reset=function(){K.target.copy(K.target0);K.object.position.copy(K.position0);K.object.zoom=K.zoom0;K.object.updateProjectionMatrix();K.dispatchEvent(Z);K.update();ae=e.NONE};this.update=function(){var aj=new THREE.Vector3();var ah=new THREE.Quaternion().setFromUnitVectors(N.up,new THREE.Vector3(0,1,0));var ai=ah.clone().inverse();var ag=new THREE.Vector3();var af=new THREE.Quaternion();return function ak(){var al=K.object.position;aj.copy(al).sub(K.target);aj.applyQuaternion(ah);S.setFromVector3(aj);if(K.autoRotate&&ae===e.NONE){z(f())}S.theta+=i.theta;S.phi+=i.phi;S.theta=Math.max(K.minAzimuthAngle,Math.min(K.maxAzimuthAngle,S.theta));S.phi=Math.max(K.minPolarAngle,Math.min(K.maxPolarAngle,S.phi));S.makeSafe();S.radius*=G;S.radius=Math.max(K.minDistance,Math.min(K.maxDistance,S.radius));K.target.add(T);aj.setFromSpherical(S);aj.applyQuaternion(ai);al.copy(K.target).add(aj);K.object.lookAt(K.target);if(K.enableDamping===true){i.theta*=(1-K.dampingFactor);i.phi*=(1-K.dampingFactor)}else{i.set(0,0,0)}G=1;T.set(0,0,0);if(I||ag.distanceToSquared(K.object.position)>c||8*(1-af.dot(K.object.quaternion))>c){K.dispatchEvent(Z);ag.copy(K.object.position);af.copy(K.object.quaternion);I=false;return true}return false}}();this.dispose=function(){K.domElement.removeEventListener("contextmenu",E,false);K.domElement.removeEventListener("mousedown",Y,false);K.domElement.removeEventListener("wheel",Q,false);K.domElement.removeEventListener("touchstart",X,false);K.domElement.removeEventListener("touchend",P,false);K.domElement.removeEventListener("touchmove",aa,false);document.removeEventListener("mousemove",a,false);document.removeEventListener("mouseup",ac,false);window.removeEventListener("keydown",j,false)};var K=this;var Z={type:"change"};var R={type:"start"};var D={type:"end"};var e={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var ae=e.NONE;var c=0.000001;var S=new THREE.Spherical();var i=new THREE.Spherical();var G=1;var T=new THREE.Vector3();var I=false;var A=new THREE.Vector2();var u=new THREE.Vector2();var L=new THREE.Vector2();var d=new THREE.Vector2();var x=new THREE.Vector2();var q=new THREE.Vector2();var y=new THREE.Vector2();var b=new THREE.Vector2();var J=new THREE.Vector2();function f(){return 2*Math.PI/60/60*K.autoRotateSpeed}function H(){return Math.pow(0.95,K.zoomSpeed)}function z(af){i.theta-=af}function C(af){i.phi-=af}var p=function(){var af=new THREE.Vector3();return function ag(ai,ah){af.setFromMatrixColumn(ah,0);af.multiplyScalar(-ai);T.add(af)}}();var B=function(){var af=new THREE.Vector3();return function ag(ai,ah){af.setFromMatrixColumn(ah,1);af.multiplyScalar(ai);T.add(af)}}();var n=function(){var ag=new THREE.Vector3();return function af(aj,ai){var ak=K.domElement===document?K.domElement.body:K.domElement;if(K.object instanceof THREE.PerspectiveCamera){var ah=K.object.position;ag.copy(ah).sub(K.target);var al=ag.length();al*=Math.tan((K.object.fov/2)*Math.PI/180);p(2*aj*al/ak.clientHeight,K.object.matrix);B(2*ai*al/ak.clientHeight,K.object.matrix)}else{if(K.object instanceof THREE.OrthographicCamera){p(aj*(K.object.right-K.object.left)/K.object.zoom/ak.clientWidth,K.object.matrix);B(ai*(K.object.top-K.object.bottom)/K.object.zoom/ak.clientHeight,K.object.matrix)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.");K.enablePan=false}}}}();function r(af){if(K.object instanceof THREE.PerspectiveCamera){G/=af}else{if(K.object instanceof THREE.OrthographicCamera){K.object.zoom=Math.max(K.minZoom,Math.min(K.maxZoom,K.object.zoom*af));K.object.updateProjectionMatrix();I=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.");K.enableZoom=false}}}function v(af){if(K.object instanceof THREE.PerspectiveCamera){G*=af}else{if(K.object instanceof THREE.OrthographicCamera){K.object.zoom=Math.max(K.minZoom,Math.min(K.maxZoom,K.object.zoom/af));K.object.updateProjectionMatrix();I=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.");K.enableZoom=false}}}function w(af){A.set(af.clientX,af.clientY)}function V(af){y.set(af.clientX,af.clientY)}function F(af){d.set(af.clientX,af.clientY)}function o(ag){u.set(ag.clientX,ag.clientY);L.subVectors(u,A);var af=K.domElement===document?K.domElement.body:K.domElement;z(2*Math.PI*L.x/af.clientWidth*K.rotateSpeed);C(2*Math.PI*L.y/af.clientHeight*K.rotateSpeed);A.copy(u);K.update()}function ad(af){b.set(af.clientX,af.clientY);J.subVectors(b,y);if(J.y>0){r(H())}else{if(J.y<0){v(H())}}y.copy(b);K.update()}function l(af){x.set(af.clientX,af.clientY);q.subVectors(x,d);n(q.x,q.y);d.copy(x);K.update()}function ab(af){}function U(af){if(af.deltaY<0){v(H())}else{if(af.deltaY>0){r(H())}}K.update()}function h(af){switch(af.keyCode){case K.keys.UP:n(0,K.keyPanSpeed);K.update();break;case K.keys.BOTTOM:n(0,-K.keyPanSpeed);K.update();break;case K.keys.LEFT:n(K.keyPanSpeed,0);K.update();break;case K.keys.RIGHT:n(-K.keyPanSpeed,0);K.update();break}}function k(af){A.set(af.touches[0].pageX,af.touches[0].pageY)}function t(ah){var ag=ah.touches[0].pageX-ah.touches[1].pageX;var af=ah.touches[0].pageY-ah.touches[1].pageY;var ai=Math.sqrt(ag*ag+af*af);y.set(0,ai)}function W(af){d.set(af.touches[0].pageX,af.touches[0].pageY)}function m(ag){u.set(ag.touches[0].pageX,ag.touches[0].pageY);L.subVectors(u,A);var af=K.domElement===document?K.domElement.body:K.domElement;z(2*Math.PI*L.x/af.clientWidth*K.rotateSpeed);C(2*Math.PI*L.y/af.clientHeight*K.rotateSpeed);A.copy(u);K.update()}function M(ah){var ag=ah.touches[0].pageX-ah.touches[1].pageX;var af=ah.touches[0].pageY-ah.touches[1].pageY;var ai=Math.sqrt(ag*ag+af*af);b.set(0,ai);J.subVectors(b,y);if(J.y>0){v(H())}else{if(J.y<0){r(H())}}y.copy(b);K.update()}function s(af){x.set(af.touches[0].pageX,af.touches[0].pageY);q.subVectors(x,d);n(q.x,q.y);d.copy(x);K.update()}function g(af){}function Y(af){if(K.enabled===false){return}af.preventDefault();if(af.button===K.mouseButtons.ORBIT){if(K.enableRotate===false){return}w(af);ae=e.ROTATE}else{if(af.button===K.mouseButtons.ZOOM){if(K.enableZoom===false){return}V(af);ae=e.DOLLY}else{if(af.button===K.mouseButtons.PAN){if(K.enablePan===false){return}F(af);ae=e.PAN}}}if(ae!==e.NONE){document.addEventListener("mousemove",a,false);document.addEventListener("mouseup",ac,false);K.dispatchEvent(R)}}function a(af){if(K.enabled===false){return}af.preventDefault();if(ae===e.ROTATE){if(K.enableRotate===false){return}o(af)}else{if(ae===e.DOLLY){if(K.enableZoom===false){return}ad(af)}else{if(ae===e.PAN){if(K.enablePan===false){return}l(af)}}}}function ac(af){if(K.enabled===false){return}ab(af);document.removeEventListener("mousemove",a,false);document.removeEventListener("mouseup",ac,false);K.dispatchEvent(D);ae=e.NONE}function Q(af){if(K.enabled===false||K.enableZoom===false||(ae!==e.NONE&&ae!==e.ROTATE)){return}af.preventDefault();af.stopPropagation();U(af);K.dispatchEvent(R);K.dispatchEvent(D)}function j(af){if(K.enabled===false||K.enableKeys===false||K.enablePan===false){return}h(af)}function X(af){if(K.enabled===false){return}switch(af.touches.length){case 1:if(K.enableRotate===false){return}k(af);ae=e.TOUCH_ROTATE;break;case 2:if(K.enableZoom===false){return}t(af);ae=e.TOUCH_DOLLY;break;case 3:if(K.enablePan===false){return}W(af);ae=e.TOUCH_PAN;break;default:ae=e.NONE}if(ae!==e.NONE){K.dispatchEvent(R)}}function aa(af){if(K.enabled===false){return}af.preventDefault();af.stopPropagation();switch(af.touches.length){case 1:if(K.enableRotate===false){return}if(ae!==e.TOUCH_ROTATE){return}m(af);break;case 2:if(K.enableZoom===false){return}if(ae!==e.TOUCH_DOLLY){return}M(af);break;case 3:if(K.enablePan===false){return}if(ae!==e.TOUCH_PAN){return}s(af);break;default:ae=e.NONE}}function P(af){if(K.enabled===false){return}g(af);K.dispatchEvent(D);ae=e.NONE}function E(af){af.preventDefault()}K.domElement.addEventListener("contextmenu",E,false);K.domElement.addEventListener("mousedown",Y,false);K.domElement.addEventListener("wheel",Q,{passive:true});K.domElement.addEventListener("touchstart",X,{passive:true});K.domElement.addEventListener("touchend",P,false);K.domElement.addEventListener("touchmove",aa,false);window.addEventListener("keydown",j,false);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){console.warn("THREE.OrbitControls: .center has been renamed to .target");return this.target}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return !this.enableZoom},set:function(a){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!a}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return !this.enableRotate},set:function(a){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!a}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return !this.enablePan},set:function(a){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!a}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");return !this.enableKeys},set:function(a){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!a}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return !this.enableDamping},set:function(a){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.enableDamping=!a}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");return this.dampingFactor},set:function(a){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.dampingFactor=a}}});